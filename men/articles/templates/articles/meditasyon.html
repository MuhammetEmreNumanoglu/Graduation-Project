{% load static %} {% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% trans "Meditasyon - İyi Hisset" %}</title>
    <link rel="icon" href="{% static 'iyihisset.png' %}" type="image/png" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link rel="stylesheet" href="{% static 'css/responsive-sidebar.css' %}" />
    <link rel="stylesheet" href="{% static 'css/global-font-size.css' %}" />
    <style>
      :root {
        --primary-color: #6a4c9c;
        --secondary-color: #8c73b8;
        --accent-color: #a38fcb;
        --background-light: #fdfdfd;
        --background-subtle: #f0eff4;
        --text-primary: #2c3e50;
        --text-secondary: #7f8c8d;
        --border-color: #e6e6ea;
        --shadow-soft: 0 6px 20px rgba(0, 0, 0, 0.07);
        --shadow-hover: 0 12px 40px rgba(0, 0, 0, 0.12);
        --border-radius-lg: 28px;
        --border-radius-md: 18px;
        --border-radius-sm: 10px;
        --transition-smooth: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: linear-gradient(135deg, #e0b4e8 0%, #b8cff0 100%);
        min-height: 100vh;
        margin: 0;
        padding: 0;
        display: flex;
        font-family: "Inter", sans-serif;
        color: var(--text-primary);
      }

      /* Main Content */
      .main-content {
        justify-content: center;
        flex: 1;
        /* margin-left: 400px; */
        padding: 48px 32px;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        box-sizing: border-box;
        position: relative;
        z-index: 1;
        min-width: 0;
      }

      /* Category Filter */
      .category-filter {
        display: flex;
        gap: 16px;
        margin-bottom: 40px;
        flex-wrap: wrap;
        justify-content: center;
        max-width: 800px;
        width: 100%;
      }

      .category-btn {
        background: rgba(255, 255, 255, 0.9);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-md);
        padding: 12px 24px;
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        cursor: pointer;
        transition: var(--transition-smooth);
        backdrop-filter: blur(10px);
        white-space: nowrap;
      }

      .category-btn:hover {
        background: var(--accent-color);
        border-color: var(--accent-color);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .category-btn.active {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--secondary-color)
        );
        border-color: var(--primary-color);
        color: white;
        box-shadow: 0 6px 20px rgba(106, 76, 156, 0.3);
      }

      /* Meditation List */
      .meditation-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 28px;
        max-width: 1200px;
        width: 100%;
        padding: 0;
      }

      .meditation-card {
        background: linear-gradient(
          160deg,
          rgba(255, 255, 255, 0.98) 0%,
          rgba(255, 255, 255, 0.92) 100%
        );
        border-radius: var(--border-radius-lg);
        padding: 32px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 20px;
        cursor: pointer;
        transition: var(--transition-smooth);
        box-shadow: var(--shadow-soft);
        border: 1px solid var(--border-color);
        backdrop-filter: blur(12px);
        position: relative;
        overflow: hidden;
      }

      .meditation-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--accent-color)
        );
        border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
      }

      .meditation-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-hover);
        border-color: rgba(106, 76, 156, 0.2);
      }

      .meditation-card-img {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        border: 4px solid var(--background-light);
        flex-shrink: 0;
        transition: var(--transition-smooth);
      }

      .meditation-card:hover .meditation-card-img {
        transform: scale(1.05);
      }

      .meditation-card-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin: 0;
        line-height: 1.3;
      }

      .meditation-card-category {
        background: var(--background-subtle);
        color: var(--primary-color);
        padding: 6px 16px;
        border-radius: var(--border-radius-sm);
        font-size: 0.9rem;
        font-weight: 600;
      }

      /* Audio Player */
      .audio-player-area {
        width: 100%;
        max-width: 420px;
        margin: 24px auto 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
        background: none;
        box-shadow: none;
        border-radius: 0;
        overflow: visible;
      }

      .audio-card {
        width: 100%;
        max-width: 400px;
        background: linear-gradient(160deg, #fff 0%, #f7f5ff 100%);
        border-radius: 24px;
        box-shadow: 0 4px 24px rgba(106, 76, 156, 0.13);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
        padding: 28px 18px;
        position: relative;
        border: 1.5px solid #ece6fa;
        margin: 0 auto;
        overflow: hidden;
      }

      .audio-controls {
        width: 100%;
        height: 80px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 16px;
        margin-bottom: 16px;
      }

      .secondary-controls {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }

      .control-btn {
        background: #ece6fa;
        color: var(--primary-color);
        border: none;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        font-size: 1.4rem;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(106, 76, 156, 0.08);
        cursor: pointer;
        transition: var(--transition-smooth);
      }

      .control-btn:hover {
        background: var(--primary-color);
        color: white;
        transform: scale(1.05);
      }

      .audio-btn {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--accent-color)
        );
        color: white;
        border: none;
        border-radius: 50%;
        width: 64px;
        height: 64px;
        font-size: 2.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 16px rgba(106, 76, 156, 0.13);
        cursor: pointer;
        z-index: 2;
      }

      .speed-btn {
        background: #ece6fa;
        color: var(--primary-color);
        border: none;
        border-radius: 12px;
        padding: 8px 16px;
        font-size: 1.1rem;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(106, 76, 156, 0.08);
        cursor: pointer;
        z-index: 2;
      }

      .back-btn {
        position: absolute;
        top: 18px;
        right: 18px;
        background: #ece6fa;
        color: var(--primary-color);
        border: none;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.6rem;
        box-shadow: 0 2px 8px rgba(106, 76, 156, 0.08);
        cursor: pointer;
        z-index: 3;
      }

      .audio-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        margin-bottom: 20px;
      }

      .track-img {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
        border: 5px solid var(--background-light);
      }

      .audio-title {
        font-size: 2.2rem;
        font-weight: 800;
        color: var(--primary-color);
        margin: 0;
        line-height: 1.2;
        text-align: center;
      }

      .audio-time {
        display: flex;
        justify-content: space-between;
        font-size: 0.95rem;
        color: var(--text-secondary);
        margin-bottom: 18px;
        width: 100%;
      }

      .seek-bar-container {
        width: 100%;
        margin-bottom: 32px;
      }

      .seek-bar {
        width: 100%;
        height: 8px;
        background: var(--background-subtle);
        border-radius: 4px;
        cursor: pointer;
        position: relative;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .seek-bar-progress {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--accent-color),
          var(--primary-color)
        );
        border-radius: 4px;
        transition: width 0.1s linear;
      }

      .seek-bar-handle {
        position: absolute;
        top: 50%;
        left: 0%;
        width: 16px;
        height: 16px;
        background: white;
        border: 3px solid var(--primary-color);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        cursor: grab;
        box-shadow: 0 2px 8px rgba(106, 76, 156, 0.3);
        transition: transform 0.1s ease;
        z-index: 10;
      }

      .seek-bar-handle:hover {
        transform: translate(-50%, -50%) scale(1.2);
        box-shadow: 0 4px 12px rgba(106, 76, 156, 0.4);
      }

      .seek-bar-handle:active {
        cursor: grabbing;
        transform: translate(-50%, -50%) scale(1.1);
      }

      .volume-btn {
        background: #ece6fa;
        color: var(--primary-color);
        border: none;
        border-radius: 12px;
        padding: 8px 16px;
        font-size: 1.1rem;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(106, 76, 156, 0.08);
        cursor: pointer;
        z-index: 2;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .volume-slider {
        width: 120px;
        height: 8px;
        background: linear-gradient(
          90deg,
          var(--accent-color) 100%,
          var(--background-subtle) 100%
        );
        border-radius: 4px;
        outline: none;
        cursor: pointer;
        -webkit-appearance: none;
        appearance: none;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        margin-top: 10px;
      }

      .volume-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: #fff;
        border: 4px solid var(--primary-color);
        box-shadow: 0 3px 12px rgba(106, 76, 156, 0.4);
        cursor: grab;
        transition: var(--transition-smooth);
      }

      .volume-slider::-webkit-slider-thumb:hover {
        transform: scale(1.15);
        box-shadow: 0 6px 18px rgba(106, 76, 156, 0.5);
      }

      .loop-btn {
        background: #ece6fa;
        color: var(--primary-color);
        border: none;
        border-radius: 12px;
        padding: 8px 16px;
        font-size: 1.1rem;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(106, 76, 156, 0.08);
        cursor: pointer;
        transition: var(--transition-smooth);
      }

      .loop-btn:hover {
        background: var(--primary-color);
        color: white;
        transform: scale(1.05);
      }

      /* Responsive */
      @media (max-width: 991px) {
        .sidebar-container {
          width: 100vw;
          min-width: 0;
          max-width: 100vw;
        }

        .main-content {
          margin-left: 0;
          padding: 100px 24px 24px 24px;
          max-width: 100vw;
        }

        body.sidebar-open {
          overflow: hidden;
        }

        .meditation-list {
          grid-template-columns: 1fr;
          max-width: 450px;
        }

        .meditation-card {
          padding: 24px;
        }

        .meditation-card-img {
          width: 90px;
          height: 90px;
        }

        .meditation-card-title {
          font-size: 1.3rem;
        }

        .audio-player-area {
          padding: 10px;
        }

        .audio-card {
          padding: 30px 24px;
        }

        .track-img {
          width: 150px;
          height: 150px;
        }

        .audio-title {
          font-size: 1.8rem;
        }

        .audio-btn {
          width: 64px;
          height: 64px;
          font-size: 1.6rem;
        }

        .back-btn {
          left: 15px;
          top: 15px;
          font-size: 1.8rem;
          width: 48px;
          height: 48px;
        }

        .category-filter {
          gap: 12px;
          margin-bottom: 30px;
        }

        .category-btn {
          padding: 10px 18px;
          font-size: 0.9rem;
        }
      }

      @media (max-width: 600px) {
        .main-content {
          padding: 80px 16px 16px 16px;
        }

        .meditation-card {
          padding: 20px;
        }

        .meditation-card-img {
          width: 80px;
          height: 80px;
        }

        .meditation-card-title {
          font-size: 1.2rem;
        }

        .audio-player-area {
          max-width: 98vw;
          padding: 0;
        }

        .audio-card {
          max-width: 98vw;
          padding: 16px 4px;
        }

        .track-img {
          width: 120px;
          height: 120px;
        }

        .audio-title {
          font-size: 1.5rem;
        }

        .audio-controls {
          gap: 15px;
        }

        .audio-btn {
          width: 56px;
          height: 56px;
          font-size: 1.4rem;
        }

        .speed-btn {
          font-size: 0.85rem;
          padding: 8px 14px;
          min-width: 60px;
        }

        .volume-slider {
          width: 70px;
        }

        .category-filter {
          gap: 8px;
          margin-bottom: 24px;
        }

        .category-btn {
          padding: 8px 14px;
          font-size: 0.85rem;
        }
      }

      .sidebar-container {
        width: 400px;
        min-width: 400px;
        max-width: 400px;
        flex-shrink: 0;
        z-index: 2;
        background: #fff;
      }

      .sidebar-title-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 18px;
        width: 100%;
        text-align: left;
        position: relative;
      }
      .sidebar-title-text::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 40px;
        height: 3px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--secondary-color)
        );
        border-radius: 2px;
      }
      .sidebar-tasks {
        display: flex;
        flex-direction: column;
        gap: 12px;
        width: 100%;
        min-height: 0;
      }
      .sidebar-task-item {
        background: rgba(139, 92, 246, 0.1);
        border-radius: 12px;
        padding: 16px;
        font-size: 1rem;
        color: var(--text-primary);
        font-weight: 500;
        box-shadow: 0 1px 4px rgba(140, 82, 255, 0.04);
        border: 1px solid transparent;
        transition: var(--transition-smooth);
        cursor: pointer;
        position: relative;
        overflow: hidden;
      }
      .sidebar-task-item::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }
      .sidebar-task-item:hover {
        background: rgba(139, 92, 246, 0.15);
        box-shadow: 0 2px 8px rgba(140, 82, 255, 0.09);
        border-color: rgba(139, 92, 246, 0.2);
        transform: translateX(4px);
      }
      .sidebar-task-item:hover::before {
        left: 100%;
      }

      /* Dark Mode Styles */
      body.dark-mode {
        background: #181818 !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .main-content {
        background: #232323 !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .page-title {
        color: #e0e0e0 !important;
      }

      body.dark-mode .page-subtitle {
        color: #b0b0b0 !important;
      }

      /* Sidebar dark mode */
      body.dark-mode .sidebar-container {
        background: #1a1a1a !important;
        border-color: #333 !important;
      }

      

      body.dark-mode .sidebar-nav a {
        background: #333 !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .sidebar-nav a:hover {
        background: #4a4a4a !important;
        color: #fff !important;
      }

      body.dark-mode .sidebar-nav a.active {
        background: var(--primary-color) !important;
        color: white !important;
      }
      body.dark-mode .sidebar-block.sidebar-title {
            background: #181818 !important;
            color: #f8f8ff !important;
            border-color: #29293a !important;
        }
        body.dark-mode .sidebar-block.sidebar-title * {
            color: #f8f8ff !important;
        }
      body.dark-mode .sidebar-user {
        background: #181818 !important;
        border-color: #333 !important;
      }

      body.dark-mode .user-info h3 {
        color: #e0e0e0 !important;
      }

      body.dark-mode .user-info p {
        color: #b0b0b0 !important;
        font-size: 0.9rem !important;
        white-space: nowrap !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        max-width: 200px !important;
      }

      body.dark-mode .menu-item {
        color: #e0e0e0 !important;
      }

      body.dark-mode .menu-item:hover {
        background: #333 !important;
        color: var(--primary-color) !important;
      }

      body.dark-mode .menu-item.active {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
        color: white !important;
      }

      body.dark-mode .sidebar-title-text {
        color: var(--primary-color) !important;
      }

      body.dark-mode .sidebar-task-item {
        background: #333 !important;
        color: #e0e0e0 !important;
        border-color: #444 !important;
      }

      body.dark-mode .sidebar-task-item:hover {
        background: #444 !important;
        color: #fff !important;
        border-color: var(--primary-color) !important;
      }

      body.dark-mode .category-btn {
        background: #333 !important;
        border-color: #555 !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .category-btn:hover {
        background: var(--primary-color) !important;
        border-color: var(--primary-color) !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .category-btn.active {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
        border-color: var(--primary-color) !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .meditation-card {
        background: #181818 !important;
        border-color: #444 !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .meditation-card:hover {
        border-color: var(--primary-color) !important;
      }

      body.dark-mode .meditation-card-title {
        color: #e0e0e0 !important;
      }

      body.dark-mode .meditation-card-category {
        background: #333 !important;
        color: var(--primary-color) !important;
      }

      body.dark-mode .audio-card {
        background: #181818 !important;
        border-color: #444 !important;
        color: #e0e0e0 !important;
      }

      body.dark-mode .audio-title {
        color: var(--primary-color) !important;
      }

      body.dark-mode .audio-time {
        color: #b0b0b0 !important;
      }

      body.dark-mode .seek-bar {
        background: #333 !important;
      }

      body.dark-mode .seek-bar-progress {
        background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)) !important;
      }

      body.dark-mode .speed-btn {
        background: #333 !important;
        color: var(--primary-color) !important;
      }

      body.dark-mode .back-btn {
        background: #444 !important;
        color: #e0e0e0 !important;
        border: 2px solid var(--primary-color) !important;
        box-shadow: 0 4px 16px rgba(106, 76, 156, 0.3) !important;
      }
      
      body.dark-mode .back-btn:hover {
        background: #555 !important;
        color: #ffffff !important;
        border-color: var(--secondary-color) !important;
        box-shadow: 0 6px 20px rgba(106, 76, 156, 0.4) !important;
        transform: scale(1.05) !important;
      }

      body.dark-mode .volume-slider {
        background: linear-gradient(90deg, var(--primary-color) 100%, #333 100%) !important;
      }

      body.dark-mode .volume-slider::-webkit-slider-thumb {
        background: #333 !important;
        border-color: var(--primary-color) !important;
      }


      body.dark-mode input,
      body.dark-mode textarea,
      body.dark-mode select {
        background: #333 !important;
        color: #e0e0e0 !important;
        border-color: #555 !important;
      }

      body.dark-mode .card,
      body.dark-mode .box,
      body.dark-mode .panel {
        background: #181818 !important;
        color: #e0e0e0 !important;
        border-color: #444 !important;
      }

      body.dark-mode a {
        color: var(--primary-color) !important;
      }

      body.dark-mode .btn {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
        color: #e0e0e0 !important;
      }

      .notification-bell {
        position: fixed;
        top: 32px;
        right: 48px;
        z-index: 1200;
        background: linear-gradient(135deg, #a084e8 0%, #6c3eb4 100%);
        border-radius: 50%;
        padding: 12px;
        border: none;
        cursor: pointer;
        font-size: 2.2rem;
        color: #fff;
        box-shadow: 0 4px 16px rgba(139, 92, 246, 0.13);
        transition: color 0.2s, background 0.2s, box-shadow 0.2s, transform 0.18s;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .notification-bell:hover {
        transform: scale(1.08);
      }
      .notification-popup {
        display: block;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        position: fixed;
        top: 72px;
        right: 48px;
        width: 340px;
        max-height: 270px;
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 8px 32px rgba(139, 92, 246, 0.18);
        border: 1.5px solid #ece6fa;
        z-index: 1300;
        overflow-y: auto;
        padding: 0;
        transform: translateY(-20px);
        transition: opacity 0.35s cubic-bezier(.4,0,.2,1), transform 0.35s cubic-bezier(.4,0,.2,1), visibility 0.35s;
      }
      .notification-popup.active {
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
        transform: translateY(0);
      }
      .notification-popup .popup-title {
        font-weight: 700;
        font-size: 1.2rem;
        padding: 18px 24px 8px 24px;
        color: #8b5cf6;
        border-bottom: 1px solid #ece6fa;
      }
      .notification-list {
        list-style: none;
        margin: 0;
        padding: 0 0 8px 0;
        max-height: 340px;
        overflow-y: auto;
      }
      .notification-item {
        padding: 16px 24px;
        border-bottom: 1px solid #f3eaff;
        font-size: 1rem;
        color: #232526;
        background: none;
      }
      .notification-item:last-child {
        border-bottom: none;
      }
      @media (max-width: 600px) {
        .notification-bell {
          top: 16px;
          right: 12px;
          padding: 8px;
          font-size: 1.5rem;
        }
        .notification-popup {
          top: 48px;
          right: 8px;
          width: 95vw;
          min-width: 0;
          max-width: 98vw;
        }
      }

      /* Sidebar background overrides */
      body.dark-mode .sidebar-header,
      body.dark-mode .sidebar-user,
      body.dark-mode .sidebar-menu { background: #181818 !important; }

      /* Ensure dark mode main content background */
      body.dark-mode         .main-content { background: #23232354 !important; }
        
        @media (min-width: 1700px) {
          .main-content {
            min-width: 800px;
          }
        }
      </style>
        <link rel="stylesheet" href="{% static 'css/global-responsive.css' %}" />
  </head>
  <body>
    {% include 'articles/includes/notifications.html' %}
    <div class="sidebar-container" id="sidebarContainer">
      <div class="sidebar-header">
        <img
          src="{% static 'iyihisset.png' %}"
          alt="Logo"
          class="sidebar-logo"
        />
        <div class="sidebar-nav">
          <a href="{% url 'anasayfa' %}">{% trans "Ana Sayfa" %}</a>
          <a href="{% url 'dashboard' %}">{% trans "İyi Hisset" %}</a>
          <a href="{% url 'profile-management' %}">{% trans "Profil Yönetimi" %}</a>
        </div>
      </div>
      <div class="sidebar-user">
        <div class="user-avatar">
          <img src="{{profilePic.profile_pic.url}}" alt="" />
        </div>
        <div class="user-info">
          <h3>{{ user.username.title }}</h3>
          <p>{{ user.email }}</p>
        </div>
      </div>
      {% include 'articles/gorevlerim.html' %}
    </div>

    <main class="main-content">
      <!-- Category Filter -->
      <div class="category-filter" id="categoryFilter">
        <button class="category-btn active" data-category="all">
          {% trans "Tümü" %}
        </button>
        <button class="category-btn" data-category="sleep">
          {% trans "Uyku & Rahatlama" %}
        </button>
        <button class="category-btn" data-category="focus">
          {% trans "Odaklanma & Üretkenlik" %}
        </button>
        <button class="category-btn" data-category="nature">
          {% trans "Doğa & Farkındalık" %}
        </button>
        <button class="category-btn" data-category="morning">
          {% trans "Sabah Aktivasyonu" %}
        </button>
        <button class="category-btn" data-category="breathing">
          {% trans "Nefes & Sakinlik" %}
        </button>
      </div>

      <!-- Meditation List -->
      <div class="meditation-list" id="meditationList">
        <!-- Sleep & Relaxation -->
        <div
          class="meditation-card"
          data-category="sleep"
          onclick="showPlayer(0)"
        >
          <img
            src="{% static 'img/rain.jpg' %}"
            class="meditation-card-img"
            alt="Yağmur"
          />
          <div class="meditation-card-title">
            {% trans "Derin Uyku İçin Yağmur" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Uyku & Rahatlama" %}
          </div>
        </div>
        <div
          class="meditation-card"
          data-category="sleep"
          onclick="showPlayer(1)"
        >
          <img
          src="{% static 'img/night.jpg' %}"
          class="meditation-card-img"
            alt="Gece"
          />
          <div class="meditation-card-title">
            {% trans "Gece Meditasyonu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Uyku & Rahatlama" %}
          </div>
        </div>
        <div
          class="meditation-card"
          data-category="sleep"
          onclick="showPlayer(2)"
        >
          <img
          src="{% static 'img/moon.jpg' %}"
          class="meditation-card-img"
            alt="Ay"
          />
          <div class="meditation-card-title">
            {% trans "Ay Işığı Meditasyonu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Uyku & Rahatlama" %}
          </div>
        </div>

        <!-- Focus & Productivity -->
        <div
          class="meditation-card"
          data-category="focus"
          onclick="showPlayer(3)"
        >
          <img
          src="{% static 'img/piano.jpg' %}"
          class="meditation-card-img"
            alt="Piyano"
          />
          <div class="meditation-card-title">
            {% trans "Odaklanma Piyanosu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Odaklanma & Üretkenlik" %}
          </div>
        </div>
        <div
          class="meditation-card"
          data-category="focus"
          onclick="showPlayer(4)"
        >
          <img
          src="{% static 'img/work.jpg' %}"
          class="meditation-card-img"
            alt="Çalışma"
          />
          <div class="meditation-card-title">
            {% trans "Çalışma Odaklanması" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Odaklanma & Üretkenlik" %}
          </div>
        </div>

        <!-- Nature & Mindfulness -->
        <div
          class="meditation-card"
          data-category="nature"
          onclick="showPlayer(5)"
        >
          <img
          src="{% static 'img/wave.jpg' %}"
          class="meditation-card-img"
            alt="Dalgalar"
          />
          <div class="meditation-card-title">
            {% trans "Stres Azaltan Dalgalar" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Doğa & Farkındalık" %}
          </div>
        </div>
        <div
          class="meditation-card"
          data-category="nature"
          onclick="showPlayer(6)"
        >
          <img
          src="{% static 'img/forest.jpg' %}"
          class="meditation-card-img"
            alt="Orman"
          />
          <div class="meditation-card-title">
            {% trans "Orman Sesi Meditasyonu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Doğa & Farkındalık" %}
          </div>
        </div>

        <!-- Morning Activation -->
        <div
          class="meditation-card"
          data-category="morning"
          onclick="showPlayer(7)"
        >
          <img
          src="{% static 'img/morning.jpg' %}"
          class="meditation-card-img"
            alt="Sabah"
          />
          <div class="meditation-card-title">{% trans "Sabah Esnemesi" %}</div>
          <div class="meditation-card-category">
            {% trans "Sabah Aktivasyonu" %}
          </div>
        </div>
        <div
          class="meditation-card"
          data-category="morning"
          onclick="showPlayer(8)"
        >
          <img
          src="{% static 'img/sunset.jpg' %}"
          class="meditation-card-img"
            alt="Güneş"
          />
          <div class="meditation-card-title">
            {% trans "Güneş Doğuşu Meditasyonu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Sabah Aktivasyonu" %}
          </div>
        </div>

        <!-- Breathing & Calm -->
        <div
          class="meditation-card"
          data-category="breathing"
          onclick="showPlayer(9)"
        >
          <img
          src="{% static 'img/fire.jpg' %}"
          class="meditation-card-img"
            alt="Nefes"
          />
          <div class="meditation-card-title">
            {% trans "Ateş Meditasyonu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Nefes & Sakinlik" %}
          </div>
        </div>
        <div
          class="meditation-card"
          data-category="breathing"
          onclick="showPlayer(10)"
        >
          <img
          src="{% static 'img/calm.jpg' %}"
          class="meditation-card-img"
            alt="Sakinlik"
          />
          <div class="meditation-card-title">
            {% trans "Sakinlik Meditasyonu" %}
          </div>
          <div class="meditation-card-category">
            {% trans "Nefes & Sakinlik" %}
          </div>
        </div>
      </div>

      <!-- Audio Player -->
      <div
        class="audio-player-area"
        id="audioPlayerArea"
        style="display: none"
      ></div>
    </main>
    <script src="{% static 'js/app.js' %}"></script>
    <script src="{% static 'js/responsive-sidebar.js' %}"></script>
    <script src="{% static 'js/font-size-manager.js' %}"></script>
    <script src="{% static 'js/lang.js' %}"></script>
    <script>
      // Podcast data with real audio URLs
      const podcasts = [
        {
          title: "{% trans 'Derin Uyku İçin Yağmur' %}",
          image: "{% static 'img/rain.jpg' %}",
          audio: "/media/rain.mp3",
          category: "sleep",
        },
        {
          title: "{% trans 'Gece Meditasyonu' %}",
          image: "{% static 'img/night.jpg' %}",
          audio: "/media/night.mp3",
          category: "sleep",
        },
        {
          title: "{% trans 'Ay Işığı Meditasyonu' %}",
          image: "{% static 'img/moon.jpg' %}",
          audio: "/media/night2.mp3",
          category: "sleep",
        },
        {
          title: "{% trans 'Odaklanma Piyanosu' %}",
          image: "{% static 'img/piano.jpg' %}",
          audio: "/media/piano.mp3",
          category: "focus",
        },
        {
          title: "{% trans 'Çalışma Odaklanması' %}",
          image: "{% static 'img/work.jpg' %}",
          audio: "/media/work.mp3",
          category: "focus",
        },
        {
          title: "{% trans 'Stres Azaltan Dalgalar' %}",
          image: "{% static 'img/wave.jpg' %}",
          audio: "/media/wave.mp3",
          category: "nature",
        },
        {
          title: "{% trans 'Orman Sesi Meditasyonu' %}",
          image: "{% static 'img/forest.jpg' %}",
          audio: "/media/forest.mp3",
          category: "nature",
        },
        {
          title: "{% trans 'Sabah Esnemesi' %}",
          image: "{% static 'img/morning.jpg' %}",
          audio: "/media/morning.mp3",
          category: "morning",
        },
        {
          title: "{% trans 'Güneş Doğuşu Meditasyonu' %}",
          image: "{% static 'img/sunset.jpg' %}",
          audio: "/media/Handpan by Yuki Koshimoto.mp3",
          category: "morning",
        },
        {
          title: "{% trans 'Ateş Meditasyonu' %}",
          image: "{% static 'img/fire.jpg' %}",
          audio: "/media/fire.mp3",
          category: "breathing",
        },
        {
          title: "{% trans 'Sakinlik Meditasyonu' %}",
          image: "{% static 'img/calm.jpg' %}",
          audio: "/media/calm.mp3",
          category: "breathing",
        },
      ];

      let currentAudio = null;
      let currentPodcastIndex = 0;

      // Category filtering
      document.addEventListener("DOMContentLoaded", function () {
        const categoryButtons = document.querySelectorAll(".category-btn");
        const meditationCards = document.querySelectorAll(".meditation-card");

        categoryButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const selectedCategory = this.getAttribute("data-category");

            // Update active button
            categoryButtons.forEach((btn) => btn.classList.remove("active"));
            this.classList.add("active");

            // Filter cards
            meditationCards.forEach((card) => {
              if (
                selectedCategory === "all" ||
                card.getAttribute("data-category") === selectedCategory
              ) {
                card.style.display = "flex";
              } else {
                card.style.display = "none";
              }
            });
          });
        });
      });

      // Show audio player
      function showPlayer(index, resetTime = true, autoplay = false) {
        currentPodcastIndex = index;
        const podcast = podcasts[index];

        const playerHTML = `
                <div class="audio-card">
                    <button class="back-btn" onclick="hidePlayer()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <div class="audio-header">
                        <img src="${podcast.image}" alt="${podcast.title}" class="track-img">
                        <h2 class="audio-title">${podcast.title}</h2>
                    </div>
                    <div class="audio-time">
                        <span id="currentTime">0:00</span>
                        <span id="totalTime">0:00</span>
                    </div>
                    <div class="seek-bar-container">
                        <div class="seek-bar" onclick="seek(event)" id="seekBar">
                            <div class="seek-bar-progress" id="seekBarProgress"></div>
                            <div class="seek-bar-handle" id="seekBarHandle"></div>
                        </div>
                    </div>
                    <div class="audio-controls">
                        <button class="control-btn" onclick="previousTrack()" id="prevBtn">
                            <span class="material-symbols-outlined">skip_previous</span>
                        </button>
                        <button class="control-btn" onclick="rewind()" id="rewindBtn">
                            <span class="material-symbols-outlined">replay_10</span>
                        </button>
                        <button class="audio-btn" onclick="togglePlay()" id="playBtn">
                            <span class="material-symbols-outlined">play_arrow</span>
                        </button>
                        <button class="control-btn" onclick="forward()" id="forwardBtn">
                            <span class="material-symbols-outlined">forward_10</span>
                        </button>
                        <button class="control-btn" onclick="nextTrack()" id="nextBtn">
                            <span class="material-symbols-outlined">skip_next</span>
                        </button>
                    </div>
                    <div class="secondary-controls">
                        <button class="volume-btn" onclick="toggleVolumeSlider()" id="volumeBtn">
                            <span class="material-symbols-outlined">volume_up</span>
                        </button>
                        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50" style="display:none;">
                        <button class="speed-btn" onclick="changeSpeed()" id="speedBtn">1x</button>
                        <button class="loop-btn" onclick="toggleLoop()" id="loopBtn">
                            <span class="material-symbols-outlined">repeat</span>
                        </button>
                    </div>
                </div>
                <audio id="audioElement" src="${podcast.audio}" preload="metadata" controls style="display:none;"></audio>
            `;

        var audioArea = document.getElementById("audioPlayerArea");
        if(audioArea) {
            audioArea.innerHTML = playerHTML;
            audioArea.style.display = "flex";
        }
        document.getElementById("meditationList").style.display = "none";
        document.getElementById("categoryFilter").style.display = "none";

        // Initialize audio player
        initializeAudioPlayer(resetTime);
        
        // Kaydedilen ayarları uygula - daha uzun gecikme ile
        setTimeout(() => {
          applySavedVolume();
          applySavedSpeed();
        }, 300);

        // Autoplay istenirse otomatik başlat
        if (autoplay) {
          const audioEl = document.getElementById("audioElement");
          const playBtn = document.getElementById("playBtn");
          if (audioEl) {
            audioEl.play().then(() => {
              if (playBtn) {
                playBtn.innerHTML = '<span class="material-symbols-outlined">pause</span>';
              }
            }).catch(() => {});
          }
        }
      }

      // Hide audio player
      function hidePlayer() {
        if (currentAudio) {
          currentAudio.pause();
          currentAudio = null;
        }
        var audioArea = document.getElementById("audioPlayerArea");
        if(audioArea) {
            audioArea.style.display = "none";
        }
        document.getElementById("meditationList").style.display = "grid";
        document.getElementById("categoryFilter").style.display = "flex";
      }

      // Initialize audio player
      function initializeAudioPlayer(resetTime = true) {
        const audio = document.getElementById("audioElement");
        const playBtn = document.getElementById("playBtn");
        const volumeSlider = document.getElementById("volumeSlider");
        const speedBtn = document.getElementById("speedBtn");
        const volumeBtn = document.getElementById("volumeBtn");
        const seekBar = document.getElementById("seekBar");
        const seekBarHandle = document.getElementById("seekBarHandle");

        currentAudio = audio;
        let isDragging = false;
        
        // Audio hazır olana kadar bekle
        if (audio.readyState < 1) {
          audio.addEventListener("loadedmetadata", function() {
            // Audio hazır olduktan sonra event listener'ları ekle
            setupAudioEventListeners();
            // Total time'ı güncelle
            updateTotalTime();
          }, { once: true });
          return;
        }
        
        // Audio zaten hazırsa direkt event listener'ları ekle
        setupAudioEventListeners();
        // Total time'ı güncelle
        updateTotalTime();
        
        function setupAudioEventListeners() {

        // Play/Pause functionality
        audio.addEventListener("loadedmetadata", function () {
          updateTotalTime();
        });

        audio.addEventListener("timeupdate", function () {
          const currentTime = document.getElementById("currentTime");
          const seekBarProgress = document.getElementById("seekBarProgress");

          currentTime.textContent = formatTime(audio.currentTime);
          const progress = (audio.currentTime / audio.duration) * 100;
          seekBarProgress.style.width = progress + "%";
          
          if (!isDragging) {
            seekBarHandle.style.left = `calc(${progress}% - 8px)`;
          }
        });

        audio.addEventListener("ended", function () {
          playBtn.innerHTML =
            '<span class="material-symbols-outlined">play_arrow</span>';
          
          // Auto play next if loop is enabled
          if (audio.loop) {
            audio.play();
            playBtn.innerHTML =
              '<span class="material-symbols-outlined">pause</span>';
          } else {
            // Loop aktif değilse otomatik olarak sonraki şarkıya geç
            setTimeout(() => {
              nextTrack();
            }, 1000);
          }
        });

        // Volume control
        volumeSlider.addEventListener("input", function () {
          const volume = this.value / 100;
          audio.volume = volume;
          updateVolumeIcon(this.value);
          // Ses seviyesini localStorage'a kaydet
          saveVolumeSettings(volume);
        });

        // Seek bar drag functionality
        seekBarHandle.addEventListener("mousedown", function(e) {
          isDragging = true;
          e.preventDefault();
        });

        document.addEventListener("mousemove", function(e) {
          if (isDragging) {
            const rect = seekBar.getBoundingClientRect();
            const clickX = Math.max(0, Math.min(e.clientX - rect.left, rect.width));
            const seekTime = (clickX / rect.width) * audio.duration;
            
            // UI'ı güncelle
            updateSeekBar(seekTime, audio.duration);
            
            // Audio currentTime'ı güncelle
            audio.currentTime = seekTime;
            
            // Current time display'ı güncelle
            const currentTimeDisplay = document.getElementById("currentTime");
            if (currentTimeDisplay) {
              currentTimeDisplay.textContent = formatTime(seekTime);
            }
          }
        });

        document.addEventListener("mouseup", function() {
          isDragging = false;
        });

        // Speed control - localStorage ile kaydet
        let speedIndex = parseInt(localStorage.getItem('meditationSpeedIndex')) || 0;
        const speeds = [1, 1.25, 1.5, 1.75, 2, 0.5, 0.75];

        function changeSpeed() {
          const audio = document.getElementById("audioElement");
          if (!audio) return;
          
          speedIndex = (speedIndex + 1) % speeds.length;
          audio.playbackRate = speeds[speedIndex];
          speedBtn.textContent = speeds[speedIndex] + "x";
          // localStorage'a kaydet
          localStorage.setItem('meditationSpeedIndex', speedIndex.toString());
        }
        
        // Sayfa yüklendiğinde kaydedilen hızı uygula
        function applySavedSpeed() {
          const audio = document.getElementById("audioElement");
          if (!audio) return;
          
          if (speeds[speedIndex]) {
            audio.playbackRate = speeds[speedIndex];
            speedBtn.textContent = speeds[speedIndex] + "x";
          } else {
            // Audio henüz hazır değilse bekle
            audio.addEventListener("loadedmetadata", function() {
              if (speeds[speedIndex]) {
                audio.playbackRate = speeds[speedIndex];
                speedBtn.textContent = speeds[speedIndex] + "x";
              }
            }, { once: true });
          }
        }
        
        // Global olarak erişilebilir yap
        window.applySavedSpeed = applySavedSpeed;

        // Global olarak erişilebilir yap
        window.changeSpeed = changeSpeed;

        if (resetTime) {
          audio.currentTime = 0;
        }
        
        // Kaydedilen ses seviyesi ve hız ayarlarını uygula
        applySavedVolume();
        applySavedSpeed();
        } // setupAudioEventListeners fonksiyonunun kapanışı
      }

      // Toggle volume slider
      function toggleVolumeSlider() {
        const volumeSlider = document.getElementById("volumeSlider");
        const volumeBtn = document.getElementById("volumeBtn");
        
        if (volumeSlider.style.display === "none" || volumeSlider.style.display === "") {
          volumeSlider.style.display = "block";
          volumeBtn.innerHTML = '<span class="material-symbols-outlined">volume_down</span>';
        } else {
          volumeSlider.style.display = "none";
          volumeBtn.innerHTML = '<span class="material-symbols-outlined">volume_up</span>';
        }
      }
      
      // Ses seviyesi ayarlarını localStorage ile kaydet
      function saveVolumeSettings(volume) {
        localStorage.setItem('meditationVolume', volume.toString());
        updateVolumeIcon(volume);
      }
      
      // Kaydedilen ses seviyesini uygula
      function applySavedVolume() {
        const audio = document.getElementById("audioElement");
        if (!audio) return;
        
        const savedVolume = localStorage.getItem('meditationVolume');
        if (savedVolume !== null) {
          const volume = parseFloat(savedVolume);
          audio.volume = volume;
          updateVolumeIcon(volume);
          
          // Volume slider'ı güncelle
          const volumeSlider = document.getElementById("volumeSlider");
          if (volumeSlider) {
            volumeSlider.value = volume * 100;
          }
        } else {
          // Varsayılan ses seviyesi
          audio.volume = 0.5;
          updateVolumeIcon(0.5);
          
          const volumeSlider = document.getElementById("volumeSlider");
          if (volumeSlider) {
            volumeSlider.value = 50;
          }
        }
        
        // Audio henüz hazır değilse bekle
        if (audio.readyState < 1) {
          audio.addEventListener("loadedmetadata", function() {
            applySavedVolume();
          }, { once: true });
        }
      }
      
      // Global olarak erişilebilir yap
      window.applySavedVolume = applySavedVolume;

      // Toggle play/pause
      function togglePlay() {
        const audio = document.getElementById("audioElement");
        const playBtn = document.getElementById("playBtn");

        if (audio.paused) {
          audio.play();
          playBtn.innerHTML =
            '<span class="material-symbols-outlined">pause</span>';
        } else {
          audio.pause();
          playBtn.innerHTML =
            '<span class="material-symbols-outlined">play_arrow</span>';
        }
      }

      // Seek functionality
      function seek(event) {
        const audio = document.getElementById("audioElement");
        if (!audio || !audio.duration) return;
        
        const seekBar = event.currentTarget;
        const rect = seekBar.getBoundingClientRect();
        const clickX = event.clientX - rect.left;
        const seekBarWidth = seekBar.offsetWidth;
        const seekTime = (clickX / seekBarWidth) * audio.duration;

        audio.currentTime = seekTime;
        
        // UI'ı güncelle
        updateSeekBar(seekTime, audio.duration);
        
        // Current time display'ı güncelle
        const currentTimeDisplay = document.getElementById("currentTime");
        if (currentTimeDisplay) {
          currentTimeDisplay.textContent = formatTime(seekTime);
        }
      }

      // 10 sn ileri/geri işlemleri için güvenli sarmaya yardımcı
      function safeSeek(deltaSeconds) {
        const audio = document.getElementById("audioElement");
        if (!audio) return;
        
        // Audio hazır değilse bekle
        if (audio.readyState < 1 || isNaN(audio.duration)) {
          audio.addEventListener("loadedmetadata", () => safeSeek(deltaSeconds), { once: true });
          return;
        }
        
        const duration = audio.duration;
        const current = audio.currentTime;
        const target = Math.max(0, Math.min(duration, current + deltaSeconds));
        
        // Audio currentTime'ı güncelle
        audio.currentTime = target;
        
        // UI'ı güncelle
        updateSeekBar(target, duration);
        
        // Current time display'ı güncelle
        const currentTimeDisplay = document.getElementById("currentTime");
        if (currentTimeDisplay) {
          currentTimeDisplay.textContent = formatTime(target);
        }
      }

      // Rewind 10 seconds - global olarak erişilebilir
      function rewind() {
        const audio = document.getElementById("audioElement");
        if (!audio) return;
        
        // Audio hazır değilse bekle
        if (audio.readyState < 1 || isNaN(audio.duration)) {
          audio.addEventListener("loadedmetadata", () => rewind(), { once: true });
          return;
        }
        
        const duration = audio.duration;
        const current = audio.currentTime;
        const target = Math.max(0, current - 10);
        
        audio.currentTime = target;
        updateSeekBar(target, duration);
        
        const currentTimeDisplay = document.getElementById("currentTime");
        if (currentTimeDisplay) {
          currentTimeDisplay.textContent = formatTime(target);
        }
      }

      // Forward 10 seconds - global olarak erişilebilir
      function forward() {
        const audio = document.getElementById("audioElement");
        if (!audio) return;
        
        // Audio hazır değilse bekle
        if (audio.readyState < 1 || isNaN(audio.duration)) {
          audio.addEventListener("loadedmetadata", () => forward(), { once: true });
          return;
        }
        
        const duration = audio.duration;
        const current = audio.currentTime;
        const target = Math.min(duration, current + 10);
        
        audio.currentTime = target;
        updateSeekBar(target, duration);
        
        const currentTimeDisplay = document.getElementById("currentTime");
        if (currentTimeDisplay) {
          currentTimeDisplay.textContent = formatTime(target);
        }
      }
      
      // Seek bar'ı güncelle
      function updateSeekBar(currentTime, duration) {
        const seekBarProgress = document.getElementById("seekBarProgress");
        const seekBarHandle = document.getElementById("seekBarHandle");
        
        if (seekBarProgress && seekBarHandle && duration > 0) {
          const progress = (currentTime / duration) * 100;
          seekBarProgress.style.width = progress + "%";
          seekBarHandle.style.left = `calc(${progress}% - 8px)`;
        }
      }

      // Format time
      function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = Math.floor(seconds % 60);
        return `${minutes}:${remainingSeconds.toString().padStart(2, "0")}`;
      }
      
      // Total time güncelleme
      function updateTotalTime() {
        const audio = document.getElementById("audioElement");
        const totalTimeDisplay = document.getElementById("totalTime");
        if (audio && totalTimeDisplay) {
          // Audio hazır olana kadar bekle
          if (audio.readyState >= 1 && !isNaN(audio.duration)) {
            totalTimeDisplay.textContent = formatTime(audio.duration);
          } else {
            audio.addEventListener("loadedmetadata", function() {
              if (!isNaN(audio.duration)) {
                totalTimeDisplay.textContent = formatTime(audio.duration);
              }
            }, { once: true });
          }
        }
      }

      // Previous track
      function previousTrack() {
        if (currentPodcastIndex > 0) {
          showPlayer(currentPodcastIndex - 1, true, true);
        }
      }

      // Next track
      function nextTrack() {
        if (currentPodcastIndex < podcasts.length - 1) {
          showPlayer(currentPodcastIndex + 1, true, true);
        }
      }

      // Rewind 10 seconds - artık yukarıda tanımlandı
      // Forward 10 seconds - artık yukarıda tanımlandı

      // Make functions globally accessible
      window.rewind = rewind;
      window.forward = forward;

      // Toggle loop
      function toggleLoop() {
        const audio = document.getElementById("audioElement");
        const loopBtn = document.getElementById("loopBtn");
        
        audio.loop = !audio.loop;
        if (audio.loop) {
          loopBtn.style.color = "var(--accent-color)";
          loopBtn.style.background = "rgba(106, 76, 156, 0.1)";
        } else {
          loopBtn.style.color = "var(--primary-color)";
          loopBtn.style.background = "#ece6fa";
        }
      }

      // Update volume icon based on volume level
      function updateVolumeIcon(volume) {
        const volumeBtn = document.getElementById("volumeBtn");
        const icon = volumeBtn.querySelector("span");
        
        if (volume == 0) {
          icon.textContent = "volume_off";
        } else if (volume < 50) {
          icon.textContent = "volume_down";
        } else {
          icon.textContent = "volume_up";
        }
      }

      // Sidebar functionality - DOM yüklendikten sonra çalıştır
      document.addEventListener("DOMContentLoaded", function() {
        const hamburgerBtn = document.getElementById("hamburgerBtn");
        const sidebarContainer = document.getElementById("sidebarContainer");
        
        if (hamburgerBtn && sidebarContainer) {
          hamburgerBtn.addEventListener("click", function (e) {
            e.stopPropagation();
            sidebarContainer.classList.toggle("active");
            hamburgerBtn.classList.toggle("active");
            document.body.classList.toggle("sidebar-open");
          });

          document.addEventListener("click", function (e) {
            if (
              window.innerWidth <= 991 &&
              sidebarContainer.classList.contains("active")
            ) {
              if (
                !sidebarContainer.contains(e.target) &&
                !hamburgerBtn.contains(e.target)
              ) {
                sidebarContainer.classList.remove("active");
                hamburgerBtn.classList.remove("active");
                document.body.classList.remove("sidebar-open");
              }
            }
          });

          window.addEventListener("resize", function () {
            if (window.innerWidth > 991) {
              sidebarContainer.classList.remove("active");
              hamburgerBtn.classList.remove("active");
              document.body.classList.remove("sidebar-open");
            }
          });
        }
      });

      // Initialize language system
      document.addEventListener("DOMContentLoaded", function () {
        if (typeof initializeLanguage === "function") {
          initializeLanguage();
        }
      });
    </script>
    <script>
      function redirectIfSmallScreen() {
        if (
          window.innerWidth < 1300 &&
          !window.location.pathname.includes("responsive.html")
        ) {
          // Şu anki sayfanın yolunu kaydet
          localStorage.setItem(
            "lastPage",
            window.location.pathname + window.location.search
          );
          window.location.href = "{% url 'responsive' %}";
        }
      }
      redirectIfSmallScreen();
      window.addEventListener("resize", redirectIfSmallScreen);
    </script>
    <script>
      function applyThemeFromStorage() {
        const theme = localStorage.getItem('themeMode') || 'light';
        if(theme === 'dark') {
          document.body.classList.add('dark-mode');
          try {
            document.getElementById('darkModeBtn').classList.add('active');
            document.getElementById('lightModeBtn').classList.remove('active');
          } catch(e){}
        } else {
          document.body.classList.remove('dark-mode');
          try {
            document.getElementById('lightModeBtn').classList.add('active');
            document.getElementById('darkModeBtn').classList.remove('active');
          } catch(e){}
        }
      }
      document.addEventListener('DOMContentLoaded', function() {
        applyThemeFromStorage();
        const lightBtn = document.getElementById('lightModeBtn');
        const darkBtn = document.getElementById('darkModeBtn');
        if(lightBtn) lightBtn.addEventListener('click', function() {
          localStorage.setItem('themeMode', 'light');
          applyThemeFromStorage();
        });
        if(darkBtn) darkBtn.addEventListener('click', function() {
          localStorage.setItem('themeMode', 'dark');
          applyThemeFromStorage();
        });
      });
    </script>
    <script>
    // Bildirim popup davranışı ortak include içinde
    </script>
  </body>
</html>
